@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div style="width:100%;height:100%; background-image:url('/Content/Images/bj.png'); background-repeat:no-repeat; background-size:100% 100%;">
    <div class="container-fluid">
        <div class="row">
            <div style="margin-top:12%;">
                <div class="panel panel-default window-width " style="opacity: 0.8;">
                    <div class="panel-heading text-center">
                        <h4><i class="fa fa-user"></i>&nbsp;欢迎登录</h4>
                    </div>
                    <div class="panel-body">
                        <div class="panel_1" id="form1">
                            <div class="form-group">
                                <input type="text" class="form-control" name="username" placeholder="请输入用户名">
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-control" name="userpwd" placeholder="请输入密码">
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-sm-7">
                                        <input type="text" class="form-control" name="loginCode" placeholder="请输入验证码">
                                    </div>
                                    <div class="col-sm-5">
                                        <img class="yzm" src='@Url.Action("yzm")' onclick="$(this).attr('src','@Url.Action("yzm")'+'/'+new Date().getTime());" width="100" height="30" />
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn btn-primary btn-block btn-outline block full-width m-b" onclick="Checked()">&nbsp;登 录</button>
                        </div>
                        <div class="panel_2">
                            <h1>登陆成功!请稍等...</h1>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section css{
    <style type="text/css">
        .window-width {
            /*min-width: 320px;*/
            width: 320px;
            margin: 0 auto;
            max-width: 450px;
        }

        .panel_1 {
            height: 200px;
        }

        .panel_2 {
            display: none;
            height: 0px;
        }
    </style>

}
@section js{
    <script src="~/Scripts/SysFrameWork/FrameWork.js"></script>
    <!--表单验证js-->
    <script src="/Content/HPlus/js/plugins/validate/jquery.validate.min.js"></script>
    <script src="/Content/HPlus/js/plugins/validate/messages_zh.min.js"></script>
    <script type="text/javascript">
        if (window.top !== window.self)
            window.top.location = window.location;
        $(function () {
            //FormYz();
            $(document).keydown(function (e) {
                if (e.which == 13) Checked();
            });


            //$.validator.setDefaults({
            //    submitHandler: function () {
            //        Checked();
            //    }
            //});

            //$("#form1").validate();



        });

        var Checked = function () {
            $.Tools.Ajax({
                type: "post",
                url: "@Url.Action("Checked")",
                data: {
                    username: $("input[name='username']").val(),
                    userpwd: $("input[name='userpwd']").val(),
                    loginCode: $("input[name='loginCode']").val()
                },
                success: function (r) {
                    if (r.status == 1) {
                        $(".panel_2").css("display", "block").animate({
                            height: "50px"
                        }, 100);
                        $(".panel_1").css({ "height": "0px", "display": "none" });
                        setTimeout(function () { window.location.href = r.jumpurl; }, 1000);
                    }
                    else {
                        $(".panel_1").css("display", "block").animate({
                            height: "200px"
                        }, 300);
                        $(".panel_2").css({ "height": "0px", "display": "none" });
                    }
                }
            });
        }

        //表单验证
        function FormYz() {
            var icon = "<i class='fa fa-times-circle'></i> ";
            $("#form1").validate({
                debug: true,
                rules: {
                    username: "required",
                    userpwd: "required",
                    username: {
                        required: true,
                        minlength: 3,
                        maxlength: 11
                    },
                    userpwd: {
                        required: true,
                        minlength: 5
                    }
                },
                messages: {
                    username: icon + "请输入用户名",
                    userpwd: icon + "请输入密码",
                    username: {
                        required: icon + "请输入用户名",
                        minlength: icon + "用户名必须3个字符以上",
                        maxlength: icon + "用户名长度不能超过11个字符"
                    },
                    userpwd: {
                        required: icon + "请输入密码",
                        minlength: icon + "密码必须5个字符以上"
                    }
                }
            });
        }

    </script>
}
